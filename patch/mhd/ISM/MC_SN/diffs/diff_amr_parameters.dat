module amr_parameters						module amr_parameters

  ! Define real types						  ! Define real types
  integer,parameter::sp=kind(1.0E0)				  integer,parameter::sp=kind(1.0E0)
#ifndef NPRE							#ifndef NPRE
  integer,parameter::dp=kind(1.0E0) ! default			  integer,parameter::dp=kind(1.0E0) ! default
#else								#else
#if NPRE==4							#if NPRE==4
  integer,parameter::dp=kind(1.0E0) ! real*4			  integer,parameter::dp=kind(1.0E0) ! real*4
#else								#else
  integer,parameter::dp=kind(1.0D0) ! real*8			  integer,parameter::dp=kind(1.0D0) ! real*8
#endif								#endif
#endif								#endif
#ifdef QUADHILBERT						#ifdef QUADHILBERT
  integer,parameter::qdp=kind(1.0_16) ! real*16			  integer,parameter::qdp=kind(1.0_16) ! real*16
#else								#else
  integer,parameter::qdp=kind(1.0_8) ! real*8			  integer,parameter::qdp=kind(1.0_8) ! real*8
#endif								#endif
  integer,parameter::MAXOUT=1000				  integer,parameter::MAXOUT=1000
  integer,parameter::MAXLEVEL=100				  integer,parameter::MAXLEVEL=100
  								  
  ! Number of dimensions					  ! Number of dimensions
#ifndef NDIM							#ifndef NDIM
  integer,parameter::ndim=1					  integer,parameter::ndim=1
#else								#else
  integer,parameter::ndim=NDIM					  integer,parameter::ndim=NDIM
#endif								#endif
  integer,parameter::twotondim=2**ndim				  integer,parameter::twotondim=2**ndim
  integer,parameter::threetondim=3**ndim			  integer,parameter::threetondim=3**ndim
  integer,parameter::twondim=2*ndim				  integer,parameter::twondim=2*ndim

  ! Vectorization parameter					  ! Vectorization parameter
#ifndef NVECTOR							#ifndef NVECTOR
  integer,parameter::nvector=500  ! Size of vector sweeps	  integer,parameter::nvector=500  ! Size of vector sweeps
#else								#else
  integer,parameter::nvector=NVECTOR				  integer,parameter::nvector=NVECTOR
#endif								#endif

  integer, parameter :: nstride = 65536				  integer, parameter :: nstride = 65536

  ! Run control							  ! Run control
  logical::verbose =.false.   ! Write everything		  logical::verbose =.false.   ! Write everything
  logical::hydro   =.false.   ! Hydro activated			  logical::hydro   =.false.   ! Hydro activated
  logical::pic     =.false.   ! Particle In Cell activated	  logical::pic     =.false.   ! Particle In Cell activated
  logical::poisson =.false.   ! Poisson solver activated	  logical::poisson =.false.   ! Poisson solver activated
  logical::cosmo   =.false.   ! Cosmology activated		  logical::cosmo   =.false.   ! Cosmology activated
  logical::star    =.false.   ! Star formation activated	  logical::star    =.false.   ! Star formation activated
  logical::sink    =.false.   ! Sink particles activated	  logical::sink    =.false.   ! Sink particles activated
							      >	  logical::rt      =.false.   ! Radiative transfer activated
  logical::debug   =.false.   ! Debug mode activated		  logical::debug   =.false.   ! Debug mode activated
  logical::static  =.false.   ! Static mode activated		  logical::static  =.false.   ! Static mode activated
  logical::tracer  =.false.   ! Tracer particles activated	  logical::tracer  =.false.   ! Tracer particles activated
  logical::lightcone=.false.  ! Enable lightcone generation	  logical::lightcone=.false.  ! Enable lightcone generation
  logical::clumpfind=.false.  ! Enable clump finder		  logical::clumpfind=.false.  ! Enable clump finder
							      >	  logical::gas_analytics=.false.  ! Turn on a routine that ou
  logical::aton=.false.       ! Enable ATON coarse grid radia	  logical::aton=.false.       ! Enable ATON coarse grid radia

  ! Mesh parameters						  ! Mesh parameters
  integer::geom=1             ! 1: cartesian, 2: cylindrical,	  integer::geom=1             ! 1: cartesian, 2: cylindrical,
  integer::nx=1,ny=1,nz=1     ! Number of coarse cells in eac	  integer::nx=1,ny=1,nz=1     ! Number of coarse cells in eac
  integer::levelmin=1         ! Full refinement up to levelmi	  integer::levelmin=1         ! Full refinement up to levelmi
  integer::nlevelmax=1        ! Maximum number of level		  integer::nlevelmax=1        ! Maximum number of level
  integer::ngridmax=0         ! Maximum number of grids		  integer::ngridmax=0         ! Maximum number of grids
  integer,dimension(1:MAXLEVEL)::nexpand=1 ! Number of mesh e	  integer,dimension(1:MAXLEVEL)::nexpand=1 ! Number of mesh e
  integer::nexpand_bound=1    ! Number of mesh expansion for 	  integer::nexpand_bound=1    ! Number of mesh expansion for 
  real(dp)::boxlen=1.0D0      ! Box length along x direction	  real(dp)::boxlen=1.0D0      ! Box length along x direction
  character(len=128)::ordering='hilbert'			  character(len=128)::ordering='hilbert'
  logical::cost_weighting=.true. ! Activate load balancing ac	  logical::cost_weighting=.true. ! Activate load balancing ac
  ! Recursive bisection tree parameters				  ! Recursive bisection tree parameters
  integer::nbilevelmax=1      ! Max steps of bisection partit	  integer::nbilevelmax=1      ! Max steps of bisection partit
  integer::nbinodes=3         ! Max number of internal nodes	  integer::nbinodes=3         ! Max number of internal nodes
  integer::nbileafnodes=2     ! Max number of leaf (terminal)	  integer::nbileafnodes=2     ! Max number of leaf (terminal)
  real(dp)::bisec_tol=0.05d0  ! Tolerance for bisection load 	  real(dp)::bisec_tol=0.05d0  ! Tolerance for bisection load 

  ! Step parameters						  ! Step parameters
  integer::nrestart=0         ! New run or backup file number	  integer::nrestart=0         ! New run or backup file number
  integer::nstepmax=1000000   ! Maximum number of time steps	  integer::nstepmax=1000000   ! Maximum number of time steps
  integer::ncontrol=1         ! Write control variables		  integer::ncontrol=1         ! Write control variables
  integer::fbackup=1000000    ! Backup data to disk		  integer::fbackup=1000000    ! Backup data to disk
  integer::nremap=0           ! Load balancing frequency (0: 	  integer::nremap=0           ! Load balancing frequency (0: 

  ! Output parameters						  ! Output parameters
  integer::iout=1             ! Increment for output times	  integer::iout=1             ! Increment for output times
  integer::ifout=1            ! Increment for output files	  integer::ifout=1            ! Increment for output files
  integer::iback=1            ! Increment for backup files	  integer::iback=1            ! Increment for backup files
  integer::noutput=1          ! Total number of outputs		  integer::noutput=1          ! Total number of outputs
  integer::foutput=1000000    ! Frequency of outputs		  integer::foutput=1000000    ! Frequency of outputs
  integer::output_mode=0      ! Output mode (for hires runs)	  integer::output_mode=0      ! Output mode (for hires runs)
							      >	  logical::gadget_output=.false. ! Output in gadget format

  ! Lightcone parameters					  ! Lightcone parameters
  real(dp)::thetay_cone=12.5					  real(dp)::thetay_cone=12.5
  real(dp)::thetaz_cone=12.5					  real(dp)::thetaz_cone=12.5
  real(dp)::zmax_cone=2.0					  real(dp)::zmax_cone=2.0

  ! Cosmology and physical parameters				  ! Cosmology and physical parameters
  real(dp)::boxlen_ini        ! Box size in h-1 Mpc		  real(dp)::boxlen_ini        ! Box size in h-1 Mpc
  real(dp)::omega_b=0.0D0     ! Omega Baryon			  real(dp)::omega_b=0.0D0     ! Omega Baryon
  real(dp)::omega_m=1.0D0     ! Omega Matter			  real(dp)::omega_m=1.0D0     ! Omega Matter
  real(dp)::omega_l=0.0D0     ! Omega Lambda			  real(dp)::omega_l=0.0D0     ! Omega Lambda
  real(dp)::omega_k=0.0D0     ! Omega Curvature			  real(dp)::omega_k=0.0D0     ! Omega Curvature
  real(dp)::h0     =1.0D0     ! Hubble constant in km/s/Mpc	  real(dp)::h0     =1.0D0     ! Hubble constant in km/s/Mpc
  real(dp)::aexp   =1.0D0     ! Current expansion factor	  real(dp)::aexp   =1.0D0     ! Current expansion factor
  real(dp)::hexp   =0.0D0     ! Current Hubble parameter	  real(dp)::hexp   =0.0D0     ! Current Hubble parameter
							      >	  real(dp)::texp   =0.0D0     ! Current proper time
  real(dp)::n_sink =1D30      ! Sink particle density thresho	  real(dp)::n_sink =1D30      ! Sink particle density thresho
  real(dp)::m_star =-1.0      ! Star particle mass in units o	  real(dp)::m_star =-1.0      ! Star particle mass in units o
  real(dp)::n_star =0.1D0     ! Star formation density thresh	  real(dp)::n_star =0.1D0     ! Star formation density thresh
  real(dp)::t_star =0.0D0     ! Star formation time scale in 	  real(dp)::t_star =0.0D0     ! Star formation time scale in 
  real(dp)::eps_star=0.0D0    ! Star formation efficiency (0.	  real(dp)::eps_star=0.0D0    ! Star formation efficiency (0.
  real(dp)::T2_star=0.0D0     ! Typical ISM polytropic temper	  real(dp)::T2_star=0.0D0     ! Typical ISM polytropic temper
  real(dp)::g_star =1.6D0     ! Typical ISM polytropic index	  real(dp)::g_star =1.6D0     ! Typical ISM polytropic index
  real(dp)::jeans_ncells=-1   ! Jeans polytropic EOS		  real(dp)::jeans_ncells=-1   ! Jeans polytropic EOS
  real(dp)::del_star=2.D2     ! Minimum overdensity to define	  real(dp)::del_star=2.D2     ! Minimum overdensity to define
  real(dp)::eta_sn =0.0D0     ! Supernova mass fraction		  real(dp)::eta_sn =0.0D0     ! Supernova mass fraction
  real(dp)::yield  =0.0D0     ! Supernova yield			  real(dp)::yield  =0.0D0     ! Supernova yield
  real(dp)::f_ek   =1.0D0     ! Supernovae kinetic energy fra	  real(dp)::f_ek   =1.0D0     ! Supernovae kinetic energy fra
  real(dp)::rbubble=0.0D0     ! Supernovae superbubble radius	  real(dp)::rbubble=0.0D0     ! Supernovae superbubble radius
  real(dp)::f_w    =0.0D0     ! Supernovae mass loading facto	  real(dp)::f_w    =0.0D0     ! Supernovae mass loading facto
  integer ::ndebris=1         ! Supernovae debris particle nu	  integer ::ndebris=1         ! Supernovae debris particle nu
  real(dp)::mass_gmc=-1.0     ! Stochastic exploding GMC mass	  real(dp)::mass_gmc=-1.0     ! Stochastic exploding GMC mass
  real(dp)::z_ave  =0.0D0     ! Average metal abundance		  real(dp)::z_ave  =0.0D0     ! Average metal abundance
  real(dp)::B_ave  =0.0D0     ! Average magnetic field		  real(dp)::B_ave  =0.0D0     ! Average magnetic field
  real(dp)::z_reion=8.5D0     ! Reionization redshift		  real(dp)::z_reion=8.5D0     ! Reionization redshift
  real(dp)::T2_start          ! Starting gas temperature	  real(dp)::T2_start          ! Starting gas temperature
  real(dp)::t_delay=1.0D1     ! Feedback time delay in Myr	  real(dp)::t_delay=1.0D1     ! Feedback time delay in Myr
  real(dp)::J21    =0.0D0     ! UV flux at threshold in 10^21	  real(dp)::J21    =0.0D0     ! UV flux at threshold in 10^21
  real(dp)::a_spec =1.0D0     ! Slope of the UV spectrum	  real(dp)::a_spec =1.0D0     ! Slope of the UV spectrum
  real(dp)::beta_fix=0.0D0    ! Pressure fix parameter		  real(dp)::beta_fix=0.0D0    ! Pressure fix parameter
  real(dp)::rsink_max=10      ! Sink isolation criterion in k	  real(dp)::rsink_max=10      ! Sink isolation criterion in k
  real(dp)::msink_max=1d5     ! Maximum seed mass in solar ma	  real(dp)::msink_max=1d5     ! Maximum seed mass in solar ma
							      >	  real(dp)::kappa_IR=0d0      ! IR dust opacity
							      >	  real(dp)::ind_rsink=4.0d0   ! Number of cells defining the 
							      >	  real(dp)::ir_eff=0.75       ! efficiency of the IR feedback
							      >	  real(dp)::larson_lifetime=5000! lifetime of first larson co
							      >
  logical ::self_shielding=.false.				  logical ::self_shielding=.false.
  logical ::pressure_fix=.false.				  logical ::pressure_fix=.false.
  logical ::nordlund_fix=.true.					  logical ::nordlund_fix=.true.
  logical ::cooling=.false.					  logical ::cooling=.false.
							      >	  logical ::neq_chem=.false.  ! Non-equilbrium chemistry acti
  logical ::isothermal=.false.					  logical ::isothermal=.false.
  logical ::metal=.false.					  logical ::metal=.false.
  logical ::bondi=.true.      ! Activate Bondi accretion onto |	  logical ::bondi=.false.      ! Activate Bondi accretion ont
  logical ::haardt_madau=.false.				  logical ::haardt_madau=.false.
  logical ::delayed_cooling=.false.				  logical ::delayed_cooling=.false.
  logical ::smbh=.false.					  logical ::smbh=.false.
  logical ::agn=.false.						  logical ::agn=.false.
							      >	  logical ::use_proper_time=.false.
							      >	  logical ::ir_feedback=.false. ! Activate ir feedback from a
							      >	  logical ::merge_stars=.false. ! Merge young star formation 
							      >	  logical ::flux_accretion=.false.

  ! Output times						  ! Output times
  real(dp),dimension(1:MAXOUT)::aout=1.1       ! Output expan	  real(dp),dimension(1:MAXOUT)::aout=1.1       ! Output expan
  real(dp),dimension(1:MAXOUT)::tout=0.0       ! Output times	  real(dp),dimension(1:MAXOUT)::tout=0.0       ! Output times

							      >	  ! Movie
							      >	  integer::imovout=0             ! Increment for output times
							      >	  integer::imov=1                ! Initialize
							      >	  real(kind=8)::tendmov=0.,aendmov=0.
							      >	  real(kind=8),allocatable,dimension(:)::amovout,tmovout
							      >	  logical::movie=.false.
							      >	  integer::nx_frame=512
							      >	  integer::ny_frame=512
							      >	  integer::levelmax_frame=0
							      >	  integer::ivar_frame=1
							      >	  real(kind=8),dimension(1:4)::xcentre_frame=0d0
							      >	  real(kind=8),dimension(1:4)::ycentre_frame=0d0
							      >	  real(kind=8),dimension(1:4)::zcentre_frame=0d0
							      >	  real(kind=8),dimension(1:4)::deltax_frame=0d0
							      >	  real(kind=8),dimension(1:4)::deltay_frame=0d0
							      >	  real(kind=8),dimension(1:4)::deltaz_frame=0d0
							      >
  ! Refinement parameters for each level			  ! Refinement parameters for each level
  real(dp),dimension(1:MAXLEVEL)::m_refine =-1.0 ! Lagrangian	  real(dp),dimension(1:MAXLEVEL)::m_refine =-1.0 ! Lagrangian
  real(dp),dimension(1:MAXLEVEL)::r_refine =-1.0 ! Radius of 	  real(dp),dimension(1:MAXLEVEL)::r_refine =-1.0 ! Radius of 
  real(dp),dimension(1:MAXLEVEL)::x_refine = 0.0 ! Center of 	  real(dp),dimension(1:MAXLEVEL)::x_refine = 0.0 ! Center of 
  real(dp),dimension(1:MAXLEVEL)::y_refine = 0.0 ! Center of 	  real(dp),dimension(1:MAXLEVEL)::y_refine = 0.0 ! Center of 
  real(dp),dimension(1:MAXLEVEL)::z_refine = 0.0 ! Center of 	  real(dp),dimension(1:MAXLEVEL)::z_refine = 0.0 ! Center of 
  real(dp),dimension(1:MAXLEVEL)::exp_refine = 2.0 ! Exponent	  real(dp),dimension(1:MAXLEVEL)::exp_refine = 2.0 ! Exponent
  real(dp),dimension(1:MAXLEVEL)::a_refine = 1.0 ! Ellipticit	  real(dp),dimension(1:MAXLEVEL)::a_refine = 1.0 ! Ellipticit
  real(dp),dimension(1:MAXLEVEL)::b_refine = 1.0 ! Ellipticit	  real(dp),dimension(1:MAXLEVEL)::b_refine = 1.0 ! Ellipticit
  real(dp)::var_cut_refine=-1.0 ! Threshold for variable-base	  real(dp)::var_cut_refine=-1.0 ! Threshold for variable-base
  real(dp)::mass_cut_refine=-1.0 ! Mass threshold for particl	  real(dp)::mass_cut_refine=-1.0 ! Mass threshold for particl
  integer::ivar_refine=-1 ! Variable index for refinement	  integer::ivar_refine=-1 ! Variable index for refinement

  ! Initial condition files for each level			  ! Initial condition files for each level
  logical::multiple=.false.					  logical::multiple=.false.
  character(LEN=80),dimension(1:MAXLEVEL)::initfile=' '		  character(LEN=80),dimension(1:MAXLEVEL)::initfile=' '
  character(LEN=20)::filetype='ascii'				  character(LEN=20)::filetype='ascii'

  ! Initial condition regions parameters			  ! Initial condition regions parameters
  integer,parameter::MAXREGION=100				  integer,parameter::MAXREGION=100
  integer                           ::nregion=0			  integer                           ::nregion=0
  character(LEN=10),dimension(1:MAXREGION)::region_type='squa	  character(LEN=10),dimension(1:MAXREGION)::region_type='squa
  real(dp),dimension(1:MAXREGION)   ::x_center=0.		  real(dp),dimension(1:MAXREGION)   ::x_center=0.
  real(dp),dimension(1:MAXREGION)   ::y_center=0.		  real(dp),dimension(1:MAXREGION)   ::y_center=0.
  real(dp),dimension(1:MAXREGION)   ::z_center=0.		  real(dp),dimension(1:MAXREGION)   ::z_center=0.
  real(dp),dimension(1:MAXREGION)   ::length_x=1.E10		  real(dp),dimension(1:MAXREGION)   ::length_x=1.E10
  real(dp),dimension(1:MAXREGION)   ::length_y=1.E10		  real(dp),dimension(1:MAXREGION)   ::length_y=1.E10
  real(dp),dimension(1:MAXREGION)   ::length_z=1.E10		  real(dp),dimension(1:MAXREGION)   ::length_z=1.E10
  real(dp),dimension(1:MAXREGION)   ::exp_region=2.0		  real(dp),dimension(1:MAXREGION)   ::exp_region=2.0

  ! Boundary conditions parameters				  ! Boundary conditions parameters
  integer,parameter::MAXBOUND=100				  integer,parameter::MAXBOUND=100
  logical                           ::simple_boundary=.false.	  logical                           ::simple_boundary=.false.
  integer                           ::nboundary=0		  integer                           ::nboundary=0
  integer                           ::icoarse_min=0		  integer                           ::icoarse_min=0
  integer                           ::icoarse_max=0		  integer                           ::icoarse_max=0
  integer                           ::jcoarse_min=0		  integer                           ::jcoarse_min=0
  integer                           ::jcoarse_max=0		  integer                           ::jcoarse_max=0
  integer                           ::kcoarse_min=0		  integer                           ::kcoarse_min=0
  integer                           ::kcoarse_max=0		  integer                           ::kcoarse_max=0
  integer ,dimension(1:MAXBOUND)    ::boundary_type=0		  integer ,dimension(1:MAXBOUND)    ::boundary_type=0
  integer ,dimension(1:MAXBOUND)    ::ibound_min=0		  integer ,dimension(1:MAXBOUND)    ::ibound_min=0
  integer ,dimension(1:MAXBOUND)    ::ibound_max=0		  integer ,dimension(1:MAXBOUND)    ::ibound_max=0
  integer ,dimension(1:MAXBOUND)    ::jbound_min=0		  integer ,dimension(1:MAXBOUND)    ::jbound_min=0
  integer ,dimension(1:MAXBOUND)    ::jbound_max=0		  integer ,dimension(1:MAXBOUND)    ::jbound_max=0
  integer ,dimension(1:MAXBOUND)    ::kbound_min=0		  integer ,dimension(1:MAXBOUND)    ::kbound_min=0
  integer ,dimension(1:MAXBOUND)    ::kbound_max=0		  integer ,dimension(1:MAXBOUND)    ::kbound_max=0
							      <
  integer :: myid					      <

end module amr_parameters					end module amr_parameters
